import json
import matplotlib as mpl
import matplotlib.pyplot as plt

mpl.rcParams['figure.dpi'] = 256
plt.rcParams['figure.figsize'] = [8, 4]

if __name__ == "__main__":
    json_data = json.load(open('./sp_colab/models/bart-base-gtc/trainer_state.json'))

    epochs = []
    losses = []

    eval_epoch = []
    eval_losses = []
    for i in range(len(json_data['log_history'])):
        if 'eval_loss' in json_data['log_history'][i].keys():
            eval_epoch.append(json_data['log_history'][i]['epoch'])
            eval_losses.append(json_data['log_history'][i]['eval_loss'])
        if 'loss' in json_data['log_history'][i].keys():
            epochs.append(json_data['log_history'][i]['epoch'])
            losses.append(json_data['log_history'][i]['loss'])

    plt.plot(epochs, losses)
    plt.xlabel('epochs')
    plt.ylabel('losses')
    plt.show()

    plt.plot(eval_epoch, eval_losses)
    plt.xlabel('epochs')
    plt.ylabel('eval_losses')

    plt.show()
